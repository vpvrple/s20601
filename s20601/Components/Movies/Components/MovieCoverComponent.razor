@using s20601.Components.MovieCollections.Components
@using s20601.Services

@inject IMovieService MovieSvc

@if (_loading)
{
    <MudProgressLinear Color="Color.Default" Indeterminate="true"/>
}
else
{
    <MudPaper Style="position: relative;" Elevation="0">
        @if (string.IsNullOrEmpty(_poster))
        {
            <MudPaper Class="d-flex align-center justify-center" Style="width: 100%; aspect-ratio: 2/3;">
                <MudIcon Icon="@Icons.Material.Filled.LocalMovies" Style="font-size: 6rem;" />
            </MudPaper>
        }
        else
        {
            <MudImage Src="@_poster"
                      ObjectFit="ObjectFit.Cover"
                      Alt="Movie poster"
                      Elevation="1"
                      Style="width: 100%; height: auto;"
                      Class="align-content-center"/>
        }
        <MudPaper Elevation="0" Style="position: absolute; top: 8px; right: 8px;">
            <BookmarkMovie MovieId="MovieId"/>
        </MudPaper>
    </MudPaper>
}


@code {
    [Parameter] public required int MovieId { get; set; }
    private string? _poster;
    private bool _loading;

    protected override async Task OnInitializedAsync()
    {
        _loading = true;
        _poster = await MovieSvc.GetMoviePosterByMovieId(MovieId);
        _loading = false;
    }
}