@using s20601.Services

@inject IMovieService MovieSvc

@if (_loading)
{
    <MudProgressLinear Color="Color.Default" Indeterminate="true"/>
}
else
{
    <MudAvatar Class="d-flex align-center justify-center" Style="@Style" Rounded="false">
    @if (string.IsNullOrEmpty(_image))
    {
        <MudPaper Class="d-flex align-center justify-center" Style="width: 100%; aspect-ratio: 2/3;">
            <MudIcon Icon="@Icons.Material.Filled.Person" Style="font-size: 6rem;" />
        </MudPaper>
    }
    else
    {
        <MudImage Src="@_image"
                  ObjectFit="ObjectFit.Cover"
                  Alt="Movie poster"
                  Elevation="1"
                  Style="width: 100%; height: auto;"
                  Class="align-content-center"/>
    }
    
    </MudAvatar>
}

@code {
    [Parameter] public required int PersonaId { get; set; }
    [Parameter] public string Style { get; set; }
    private string? _image;
    private bool _loading;

    protected override async Task OnInitializedAsync()
    {
        _loading = true;
        _image = await MovieSvc.GetPersonaImageById(PersonaId);
        _loading = false;
    }
}
